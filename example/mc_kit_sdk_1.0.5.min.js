(function(h,q,r){function b(){return b}function n(a,c){a&&parent.postMessage({action:a.toUpperCase(),message:c},"*")}var m,g,d,f=[],k=[],l=[];m=h.MCK;d={PRISTINE:0,PENDING:1,REJECTED:2,RESOLVED:3};g=d.PRISTINE;b.version="1.0.5";b.h5={};(function(){q.addEventListener("message",function(a){var c=a.data;a=c.action;c=c.message;if(0!==f.length&&(g===d.RESOLVED||"AUTH_SUCCESS"===a))for(var b=f.length,e;b--;)e=f[b],a===e.action&&(e.callback(c,e),e.once&&f.splice(b,1))})})();b.auth=function(){g=d.PENDING;
var a;a=document.getElementsByTagName("script");a=a[a.length-1].src.match(/[\?&]appkey=([^&]+)/i)[1];n("auth",{appKey:a,domain:location.origin})};b.ready=function(a,c){if("function"!==typeof a)return b;switch(g){case d.RESOLVED:a(b);break;case d.PRISTINE:case d.PENDING:k.push(a);break;default:"function"===typeof c&&c()}return b};b.h5.call=function(a,c,p){var e;switch(g){case d.PRISTINE:throw Error("\u8bf7\u786e\u8ba4\u4f60\u7684 appKey \u6b63\u786e.");case d.PENDING:console.log("\u4ecd\u5728\u9a8c\u8bc1\u4e2d.. \u8bf7\u4f7f\u7528 `MCK.ready(fn)` \u6ce8\u518c\u56de\u8c03.");
break;case d.RESOLVED:e=!0;break;default:throw Error("\u8bf7\u786e\u8ba4\u4f60\u7684 appKey \u6b63\u786e.");}if(e)if(a&&-1!==l.indexOf(a.toUpperCase()))"function"===typeof c&&(p=c,c=void 0),n(a,c),b.h5.watchOnce(a,function(a){p(a)});else throw Error("\u672a\u627e\u5230\u8be5 ["+a+"] API, \u8bf7\u786e\u8ba4\u4f60\u8c03\u7528\u7684 API .");};b.h5.watch=function(a,c,b){var e;if("string"===typeof a&&"function"===typeof c)return b=b||{},e=(e=b.flag)||(new Date).getTime()+(Math.random()+"").substring(2,
4),f.push({once:b.once,flag:e,action:a.toUpperCase(),callback:c}),e};b.h5.watchOnce=function(a,c,d){d=d||{};d.once=!0;b.h5.watch(a,c,d);return b};b.h5.unWatch=function(a){for(var c=f.length;c--;)if(a===f[c].flag){f.splice(c,1);break}return b};b.h5.getApi=function(){return l.concat()};b.conflict=function(){h.MCK=m;m=null;return Object.create(b)};b.auth();b.h5.watchOnce("AUTH_SUCCESS",function(a){a?g=d.RESOLVED:(k.length=0,g=d.REJECTED)});b.h5.watchOnce("AVAILABLE_API",function(a){var c;l.push.apply(l,
a);0!==k.length&&(c=h.MCK,c=b.isPrototypeOf(c)?c:Object.create(b),k.forEach(function(a){a.call(null,c)}))});h.MCK=Object.create(b);document.addEventListener("touchend",function(a){var b=a.target.tagName.toUpperCase();-1!==["INPUT","TEXTAREA"].indexOf(b)&&(window.focus(),a.target.focus())},!1)})(this,window);